<!DOCTYPE html>
<!--[if lte IE 6]><html class="preIE7 preIE8 preIE9"><![endif]-->
<!--[if IE 7]><html class="preIE8 preIE9"><![endif]-->
<!--[if IE 8]><html class="preIE9"><![endif]-->
<!--[if gte IE 9]><!--><html><!--<![endif]-->
  <head>
    <meta charset="UTF-8">
    <title>TypeSwitch</title>
    <link href="styles/default.css" rel="stylesheet" type="text/css"></link>
    <link href="https://fonts.googleapis.com/css?family=Cutive+Mono" rel="stylesheet">
  </head>
  <body>
    <div id="prompt"></div>
    <button id="startGame" class="clickable">Start</button>
    <button id="resetGame" class="faded">Reset</button>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
    <script src="../build/type-switch.min.js"></script>
    <script>
    $(document).ready(function () {
      var Game = new TypeSwitch({stubbornMode: true});

      var startGame = $('#startGame');
      var resetGame = $('#resetGame');
      var atStart = true;

      function displayPrompt(promptNum) {
        $('#prompt').html('');
        var gameStats = Game.getGameStats();
        var prompt = gameStats.prompt;
        var letterElements = prompt.split('').map(function (letter, i) {
          var letterContainer = $('<div/>', {
            class: 'letterContainer',
            promptData: 'l' + i
          });
          var letterBlock = $('<p/>').text(letter);
          var tracker = $('<p/>').text('_').addClass('tracker');
          return letterContainer.append(letterBlock, tracker);
        });
        letterElements.forEach(function (letter) {
          $('#prompt').append(letter);
        });
      }

      function incrementPosition() {

      }

      function toggleButtonFade(button) {
        if (button.hasClass('faded')) {
          button.removeClass('faded').addClass('clickable');
        } else {
          button.removeClass('clickable').addClass('faded');
        }
      };

      Game.on('correct', function () {
        console.log('correct');
      });
      Game.on('incorrect', function () {
        console.log('incorrect');
      });
      Game.on('complete', function () {
        Game.restartGame();
        console.log('complete');
      });
      startGame.on('click', function () {
        if (atStart) {
          atStart = false;
          Game.start('This is what a sentence looks like This is what a sentence looks like This is what a sentence looks like');
          displayPrompt(0);
          toggleButtonFade($(this));
          toggleButtonFade(resetGame);
        }
      });
      resetGame.on('click', function () {
        if (!atStart) {
          atStart = true;
          Game.resetGame();
          toggleButtonFade($(this));
          toggleButtonFade(startGame);
        }
      });
    });
    </script>
  </body>
</html>
